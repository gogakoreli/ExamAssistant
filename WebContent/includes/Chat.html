
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;" charset="UTF-8">

<script type="text/javascript">
	var webSocket = new WebSocket(
			"ws://localhost:8080/ExamAssistant/ChatroomServerEndpoint");

	webSocket.onmessage = function processMessage(message) {
		//var json = JSON.parse(message);

		var msgFromId = json.messageFromId;
		var msgFromName = json.messageFromName;
		var msgText = json.messageText;

		var chatdivid = 'chat' + msgFromId;
		var chatdiv = document.getElementById(chatdivid);
		if (chatdiv === null) {
			addChatWith(msgFromId, msgFromName);
			chatdiv = document.getElementById(chatdivid);
		}

		//iDiv.appendChild(innerDiv);	

		//console.log("called from " + message.data);
		//var gson = message.data;
		//messageTextArea.value += gson + "\n";
		//document.getElementById('textid');
	}

	//adds chat window 
	function addChatWith(msgFromId, msgFromName) {
		var chatdivid = 'chat' + msgFromId;
		var div = document.createElement('div');
		div.setAttribute("id", chatdivid);
		div.className = "chat";
		div.innerHTML = '<div class="chat-title" id="divchattitle' + msgFromId + '"> <p>'
				+ msgFromName
				+ '</p> </div> <div class="dd" id="divmsgflow' + msgFromId + '"> <textarea id="messageswith' + msgFromId + '" style="color: green; border: 1px solid #ffaa00;" ' +
		'readonly="readonly" rows="10" cols="45"></textarea></div> <textarea class="message-input" placeholder="Type message..." id="messagetext' + msgFromId + '"> </textarea> <input type="button" value="Send" onclick="sendMessage('
				+ msgFromId + ');" />';

		document.getElementById('chatsys').appendChild(div);
	}

	function sendMessage() {
		webSocket.send(messageText.value);
		messageText.value = "";
	}
</script>

<style>
.chat {
	width: 300px;
	height: 300px;
	overflow: hidden;
	background: rgba(0, 0, 0, .5);
	border-radius: 20px;
	display: inline-block;
}

.dd {
	flex-direction: column;
	display: flex;
}

input[type=button] {
	width: 100%;
	background-color: #248A52;
	color: white;
	padding: 12px 20px;
	margin: 8px 0;
	border: none;
	border-radius: 4px;
	cursor: pointer;
}

body {
	background-color: #f2f2f2;
	font-family: 'Open Sans', sans-serif;
	font-size: 12px;
}

.message-input {
	width: 100%;
}

.chat-title {
	flex: 0 1 45px;
	position: relative;
	background: rgba(0, 0, 0, 0.2);
	color: #fff;
	text-transform: uppercase;
	text-align: left;
	padding: 10px 10px 10px 50px;
}
</style>


</head>

<body>

	<div id='chatsys'>
		
		<script>
			addChatWith(131, 'amiran melia');
			addChatWith(132, 'gela magaltadze');
		</script>



	</div>

</body>

</html>

